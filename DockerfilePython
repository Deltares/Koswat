# To build this docker run:
# `docker build -t koswat`

# To run koswat in the container:
# `docker run 
#   -v {your_koswat_data_project}:/mnt/koswat_data koswat 
#   --input_file /mnt/koswat_data/koswat_general.ini`

FROM python:3.13-slim as BUILD

RUN curl -fsSL https://pixi.sh/install.sh | sh

WORKDIR /app
COPY README.md LICENSE pyproject.toml pixi.lock /app/
COPY koswat /app/koswat

RUN pixi install --locked -e py313
RUN pixi run -e py313 pip list --format=freeze > /app/requirements.txt

FROM python:3.13-slim as FINAL

WORKDIR /app
COPY --from=BUILD /app /app

# RUN pip install -r requirements.txt
# RUN pip install .

# Define the endpoint
CMD ["sh"]